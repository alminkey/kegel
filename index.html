
<!doctype html>
<html lang="bs">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>KegelPilot — v21 • Edu kartice</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0B0E12">
  <style>
    :root{ --bg:#0b0e12; --ink:#e0e6ef; --muted:#9aa0a6; }
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;background:radial-gradient(1200px 600px at 20% -10%,#18202b 0%,#0b0e12 60%),#0b0e12;color:#e0e6ef;font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;-webkit-tap-highlight-color:transparent;}
    .shell{min-height:100%;display:grid;grid-template-rows:auto 1fr auto}
    header{position:sticky;top:0;background:rgba(12,15,20,.8);backdrop-filter:blur(8px);border-bottom:1px solid rgba(255,255,255,.06);padding:10px 14px;display:flex;align-items:center;justify-content:space-between;gap:12px;z-index:10}
    .brandimg{height:34px} .ver{font-size:11px;color:#9aa0a6;margin-left:6px;opacity:.8}
    .protag{font-weight:900;letter-spacing:.2px;padding:6px 10px;border-radius:999px;background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.06)}
    .protag .pro{color:#ff6b6b} .protag .on{color:#66E6A8}
    main{padding:16px;display:none} main.active{display:block}
    .grid{display:grid;gap:12px}
    .card{position:relative;border-radius:16px;padding:16px 14px;border:1px solid rgba(255,255,255,.12);overflow:hidden;cursor:pointer;background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02)); backdrop-filter: blur(10px); box-shadow:0 10px 30px rgba(0,0,0,.35), inset 0 0 0 1px rgba(255,255,255,.04);}
    nav{position:sticky;bottom:0;background:rgba(10,12,16,.82);backdrop-filter:blur(10px);border-top:1px solid rgba(255,255,255,.06);display:grid;grid-template-columns:repeat(4,1fr)}
    nav button{appearance:none;border:0;background:none;color:#9aa0a6;padding:8px 6px 12px;font-weight:800;font-size:13px;display:grid;place-items:center;gap:4px;position:relative} nav button.active{color:#e0e6ef}
    /* Accordion */
    .accordion .ecard{border-radius:16px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.04); overflow:hidden}
    .ecard header{display:flex;align-items:center;justify-content:space-between;gap:8px;padding:14px 16px;cursor:pointer;user-select:none}
    .ecard header h3{margin:0;font-size:16px}
    .caret{transition:transform .2s ease; opacity:.9}
    .ecard.open .caret{transform:rotate(90deg)}
    .content{display:grid;gap:8px;padding:0 16px 14px 16px;max-height:0;overflow:hidden;transition:max-height .25s ease}
    .ecard.open .content{padding-top:0; max-height:600px}
    .muted{color:#9aa0a6}
  </style>
</head>
<body>
<div class="shell">
  <header>
    <div style="display:flex;align-items:center;gap:6px">
      <img id="brand" class="brandimg" alt="KegelPilot" loading="eager" fetchpriority="high" src="assets/logo_text.png">
      <span class="ver">v21</span>
    </div>
    <div class="protag"><span class="pro">PRO</span> <span class="on">aktivno</span></div>
  </header>

  <main id="home" class="active">
    <div class="grid">
      <div id="cardEdu" class="card" role="button" tabindex="0">O Kegel vježbama — tapni ili koristi tab “Edu”</div>
      <div id="cardQuick" class="card" role="button" tabindex="0">Brzi start — otvori Trening</div>
    </div>
  </main>

  <main id="trainer">
    <div class="grid"><div class="card">Trening (fokus test: Edu kartice)</div></div>
  </main>

  <main id="edu">
    <div class="grid accordion" id="eduAcc"></div>
  </main>

  <main id="progress">
    <div class="grid"><div class="card">Napredak — demo</div></div>
  </main>

  <nav>
    <button class="active" data-tab="home">Početna</button>
    <button data-tab="trainer">Trening</button>
    <button data-tab="edu">Edu</button>
    <button data-tab="progress">Napredak</button>
  </nav>
</div>

<script>
// HARD REFRESH once if stariji build (clears caches + SW) 
const APP_VERSION = 'v21';
(async function() {
  try {
    const saved = localStorage.getItem('kp_app_version');
    if (saved !== APP_VERSION) {
      if ('caches' in window) {
        const keys = await caches.keys();
        await Promise.all(keys.map(k => caches.delete(k)));
      }
      if ('serviceWorker' in navigator) {
        const regs = await navigator.serviceWorker.getRegistrations();
        await Promise.all(regs.map(r => r.unregister()));
      }
      localStorage.setItem('kp_app_version', APP_VERSION);
      const url = new URL(window.location.href);
      if (!url.searchParams.get('v')) {
        url.searchParams.set('v', APP_VERSION);
        window.location.replace(url.toString());
      }
    }
  } catch(e) { console.log('refresh check err', e); }
})();

// Logo fallback
(function(){
  const brand = document.getElementById('brand');
  const inlineSVG = "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='132' height='28' viewBox='0 0 132 28' fill='none'><rect x='0' y='0' rx='8' ry='8' width='132' height='28' fill='rgba(15,20,27,0.85)'/><text x='14' y='19' font-family='Inter,Segoe UI,Arial,sans-serif' font-size='16' fill='%23A7F3D0' font-weight='700'>KegelPilot</text></svg>";
  function setInline(){ brand.src = inlineSVG; }
  function tryRoot(){ brand.removeEventListener('error', tryRoot); brand.addEventListener('error', setInline, {once:true}); brand.src = 'Logo.PNG'; }
  brand.addEventListener('error', tryRoot, {once:true});
})();

// Nav
(function(){
  const pages = document.querySelectorAll('main');
  const navButtons = document.querySelectorAll('nav button');
  function showTab(id){ pages.forEach(p=>p.classList.toggle('active', p.id===id)); navButtons.forEach(b=>b.classList.toggle('active', b.getAttribute('data-tab')===id)); if (navigator.vibrate) navigator.vibrate(12);}
  navButtons.forEach(btn=>btn.addEventListener('click', (e)=>{ e.preventDefault(); showTab(btn.getAttribute('data-tab')); }));
  document.getElementById('cardEdu').addEventListener('click', ()=> showTab('edu'));
  document.getElementById('cardQuick').addEventListener('click', ()=> showTab('trainer'));
})();

// EDU accordion
(function(){
  const data = [["Šta su Kegel vježbe?", "Dno karlice je skup mišića koji idu od trtične do stidne kosti. Ti mišići podržavaju mokraćni mjehur, prostatu i rektum te pomažu u kontroli mokrenja i seksualnoj funkciji. Kegel vježbe su jednostavne kontrakcije ovih mišića s ciljem jačanja i bolje kontrole."], ["Zašto rade?", "Jačanjem dna karlice poboljšava se mehanička podrška i kontrola sfinktera, a često i stabilnost erekcije. Istraživanja pokazuju koristi za kontrolu mokrenja, erektilnu funkciju i neke oblike preranog svršavanja — posebno uz dosljedno vježbanje."], ["Kom je ovo korisno?", "• muškarcima sa slabijom erekcijom ili prijevremenom ejakulacijom\n• nakon operacije prostate (za curenje mokraće)\n• kod curenja pri kašljanju/kihanju/podizanju tereta\n• svima koji žele bolju kontrolu i stabilnost core-a"], ["Ko treba pauzirati i prvo se javiti doktoru?", "Pauziraj i posavjetuj se ako imaš hroničan bol u karlici/preponama, bol pri erekciji/ejakulaciji/orgazmu, učestalo i hitno mokrenje, izražen zatvor, svježu infekciju urinarnog trakta ili ako si nedavno operisan."], ["Kako ‘naći’ pravi mišić", "Kao da želiš zaustaviti mlaz mokraće ili spriječiti vjetar — to je otprilike pravi osjećaj. Ovo koristi samo kao test; ne vježbaj redovno tokom mokrenja. Ne stiskaj stomak, stražnjicu ni bedra i ne zadržavaj dah."], ["Osnovna tehnika u aplikaciji", "U KegelPilotu prati STEGNI → (ponekad ZADRŽI) → OPUSTI. Pulsirajući prsten te vodi kroz stisak i opuštanje, a narandžasta traka pokazuje napredak cijele sesije. Intenzitet neka bude umjeren (50–70%), uz mirno disanje."], ["Šta kažu studije", "Pregledi više studija pokazuju poboljšanja erektilne funkcije, kontrole mokrenja i često kod preranog svršavanja, posebno uz redovnost i/ili rad s fizioterapeutom za dno karlice. Napredak je postepen i zahtijeva dosljednost."], ["Česte greške", "• Prejak stisak i zamor — biraj umjereno.\n• Stiskanje stražnjice/stomaka/bedara — fokus na dno karlice.\n• Zadržavanje daha — diši mirno.\n• Previše serija prerano — drži se plana u appu."], ["Plan i motivacija", "Kreni s Rangom 1; aplikacija te vodi i postepeno uvodi varijacije. Cilj za prelazak: 2 sesije dnevno kroz 5 uzastopnih dana. Mnogi promjene primijete kroz nekoliko sedmica — strpljenje i kontinuitet su ključ."], ["Napomena", "Ovaj sadržaj je informativan i ne zamjenjuje savjet ljekara. Ako imaš simptome koji te brinu ili osjetiš pogoršanje tokom vježbi, stani i potraži stručni savjet."]];
  const host = document.getElementById('eduAcc');
  data.forEach((item, idx)=>{
    const [title, body] = item;
    const card = document.createElement('section');
    card.className = 'ecard';
    const id = 'ec'+idx;
    card.innerHTML = `
      <header role="button" aria-controls="${id}-content" aria-expanded="false" tabindex="0">
        <h3>${title}</h3>
        <svg class="caret" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M8 5v14l11-7z"/></svg>
      </header>
      <div id="${id}-content" class="content"><div class="muted" style="white-space:pre-line">${body}</div></div>
    `;
    function toggle(open){ card.classList.toggle('open', open); const h = card.querySelector('header'); h.setAttribute('aria-expanded', open? 'true':'false'); }
    card.querySelector('header').addEventListener('click', ()=>{ const isOpen = card.classList.contains('open'); document.querySelectorAll('.ecard.open').forEach(el=>el.classList.remove('open')); toggle(!isOpen); });
    card.querySelector('header').addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' '){ e.preventDefault(); card.querySelector('header').click(); } });
    host.appendChild(card);
  });
})();

// SW register with versioned URL (cache-bust)
if ('serviceWorker' in navigator) { 
  window.addEventListener('load', function() { 
    navigator.serviceWorker.register('./service-worker.js?v='+APP_VERSION).then(()=>console.log('SW registered', APP_VERSION));
  }); 
}
</script>
</body>
</html>
